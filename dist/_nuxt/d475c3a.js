(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{1016:function(t,o,r){"use strict";r.r(o);r(17),r(13),r(15),r(19),r(14),r(20);var e=r(6),n=r(0),m=(r(7),r(706)),l=r.n(m),c=r(886),d=r(707);function f(object,t){var o=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),o.push.apply(o,r)}return o}var v={layout:"admin",components:{promotionForm:c.a,PageHeader:d.a},asyncData:function(t){return Object(n.a)(regeneratorRuntime.mark((function o(){var r,e,n;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=t.params,e=t.store,o.next=3,e.dispatch("admin/promotion/showPromotion",r.id);case 3:return(n=l()(e.state.admin.promotion.editPromotion)).startDate*=1e3,n.endDate*=1e3,o.abrupt("return",{promotion:n});case 7:case"end":return o.stop()}}),o)})))()},computed:{promotionForm:function(){return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(o){Object(e.a)(t,o,source[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(source,o))}))}return t}({},this.promotion)}},methods:{updatepromotion:function(form){var t=this;return Object(n.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,t.$store.dispatch("admin/promotion/update",{id:t.promotion.id,data:form});case 3:t.$router.push("/admin/promotion/"),o.next=9;break;case 6:o.prev=6,o.t0=o.catch(0),t.$message({message:"Sửa không thành công.",type:"error"});case 9:case"end":return o.stop()}}),o,null,[[0,6]])})))()}}},h=r(12),component=Object(h.a)(v,(function(){var t=this,o=t.$createElement,r=t._self._c||o;return r("div",[r("PageHeader",{attrs:{title:t.promotion.title}}),t._v(" "),r("promotionForm",{attrs:{"promotion-data":t.promotionForm},on:{submitForm:t.updatepromotion}})],1)}),[],!1,null,null,null);o.default=component.exports},719:function(t,o,r){"use strict";r.d(o,"a",(function(){return e}));r(93),r(720),r(721),r(26),r(61);var e=function(t,o,r){o.length<t.min||o.length>t.max?r(new Error("Length should be ".concat(t.min," to ").concat(t.max))):r()}},720:function(t,o,r){var e=r(268),n=r(405),m=r(267);t.exports=function(object,t){var o={};return t=m(t,3),n(object,(function(r,n,object){e(o,n,t(r,n,object))})),o}},721:function(t,o,r){t.exports=r(722)},722:function(t,o,r){var e=r(174),n=r(723),m=r(725),l=r(26);t.exports=function(t,o){return(l(t)?e:n)(t,m(o))}},723:function(t,o,r){var e=r(405),n=r(724)(e);t.exports=n},724:function(t,o,r){var e=r(260);t.exports=function(t,o){return function(r,n){if(null==r)return r;if(!e(r))return t(r,n);for(var m=r.length,l=o?m:-1,c=Object(r);(o?l--:++l<m)&&!1!==n(c[l],l,c););return r}}},725:function(t,o,r){var e=r(170);t.exports=function(t){return"function"==typeof t?t:e}},886:function(t,o,r){"use strict";var e=r(0),n=(r(7),r(13),r(52),r(706)),m=r.n(n),l=r(735),c=r(730),d=r(708),f=r(719),v={title:"",avatar:"",description:"",searchKey:"",startDate:"",endDate:"",promotionAmount:null,maxPerOrder:null,minPerOrder:null,onHome:null},h={components:{Tinymce:l.a,ImageFinder:c.a},props:{promotionData:{type:Object,required:!1}},data:function(){return{dialogVisible:!1,loading:!1,promotionForm:this.promotionData?m()(this.promotionData):m()(v),rules:{title:[{required:!0,message:"Vui lòng nhập tiêu đề",trigger:"blur"},{min:1,max:300,validator:f.a,trigger:"blur"}]}}},methods:{toImage:d.a,openGallery:function(){this.dialogVisible=!0},confirmPick:function(t){this.dialogVisible=!1,this.promotionForm.avatar=t},descriptionChange:function(t){this.promotionForm.description=t},submitForm:function(t){var o=this;this.$refs[t].validate(function(){var t=Object(e.a)(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=6;break}o.promotionForm.startDate/=1e3,o.promotionForm.endDate/=1e3,o.$emit("submitForm",o.promotionForm),t.next=7;break;case 6:return t.abrupt("return",!1);case 7:case"end":return t.stop()}}),t)})));return function(o){return t.apply(this,arguments)}}())},resetForm:function(t){this.$refs[t].resetFields()}}},F=r(12),component=Object(F.a)(h,(function(){var t=this,o=t.$createElement,r=t._self._c||o;return r("div",[r("el-form",{ref:"promotionForm",staticClass:"w-full",attrs:{model:t.promotionForm,"label-width":"200px",rules:t.rules}},[r("el-form-item",{attrs:{label:"Tiêu đề",prop:"title"}},[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"Tiêu đề"},model:{value:t.promotionForm.title,callback:function(o){t.$set(t.promotionForm,"title",o)},expression:"promotionForm.title"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Ngày bắt đầu"}},[r("el-date-picker",{attrs:{"value-format":"timestamp",type:"date",placeholder:"Ngày bắt đầu"},model:{value:t.promotionForm.startDate,callback:function(o){t.$set(t.promotionForm,"startDate",o)},expression:"promotionForm.startDate"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Ngày kết thúc"}},[r("el-date-picker",{attrs:{"value-format":"timestamp",type:"date",placeholder:"Ngày kết thúc"},model:{value:t.promotionForm.endDate,callback:function(o){t.$set(t.promotionForm,"endDate",o)},expression:"promotionForm.endDate"}})],1),t._v(" "),r("el-form-item",{staticClass:"w-1/2",attrs:{label:"Thể loại",prop:"type"}},[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"Thể loại"},model:{value:t.promotionForm.type,callback:function(o){t.$set(t.promotionForm,"type",o)},expression:"promotionForm.type"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Sản phẩm tối thiểu",prop:"minPerOrder"}},[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{type:"number",placeholder:"Số lượng tối thiểu trên đơn hàng"},model:{value:t.promotionForm.minPerOrder,callback:function(o){t.$set(t.promotionForm,"minPerOrder",o)},expression:"promotionForm.minPerOrder"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Sản phẩm tối đa",prop:"maxPerOrder"}},[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{type:"number",placeholder:"Số lượng tối đa trên đơn hàng"},model:{value:t.promotionForm.maxPerOrder,callback:function(o){t.$set(t.promotionForm,"maxPerOrder",o)},expression:"promotionForm.maxPerOrder"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Giá trị khuyến mãi",prop:"promotionAmount"}},[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{type:"number",placeholder:"Số lượng khuyến mãi"},model:{value:t.promotionForm.promotionAmount,callback:function(o){t.$set(t.promotionForm,"promotionAmount",o)},expression:"promotionForm.promotionAmount"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Hiển thị trên trang chủ",prop:"onHome"}},[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},model:{value:t.promotionForm.onHome,callback:function(o){t.$set(t.promotionForm,"onHome",o)},expression:"promotionForm.onHome"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"Ảnh đại diện",prop:"avatar"}},[r("el-col",{attrs:{span:12}},[r("el-button",{on:{click:t.openGallery}},[t.promotionForm.avatar?r("div",[r("img",{staticClass:"w-32",attrs:{src:t.toImage(t.promotionForm.avatar,"thumbnail")}})]):r("span",[t._v("Bộ sưu tập")])]),t._v(" "),r("el-dialog",{attrs:{title:"Thư viện",visible:t.dialogVisible,width:"75%"},on:{"update:visible":function(o){t.dialogVisible=o}}},[r("ImageFinder",{on:{confirmPick:t.confirmPick}})],1)],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"Nội dung",prop:"description"}},[r("el-col",{attrs:{span:24}},[r("Tinymce",{attrs:{content:t.promotionForm.description},on:{contentChange:t.descriptionChange}})],1)],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(o){return t.submitForm("promotionForm")}}},[t._v("\n                Lưu\n            ")]),t._v(" "),r("el-button",{on:{click:function(o){return t.resetForm("promotionForm")}}},[t._v("\n                Làm mới\n            ")])],1)],1)],1)}),[],!1,null,null,null);o.a=component.exports}}]);