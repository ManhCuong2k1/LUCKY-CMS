(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{1005:function(e,t,n){"use strict";n.r(t);n(17),n(13),n(15),n(19),n(14),n(20);var r=n(6),o=n(0),c=(n(7),n(40),n(18),n(27),n(28),n(413),n(51)),l=n(702),d=n(705),j=n.n(d),f=n(729),m=n(718),h=n(707),y=n(727),object=n(726);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var w={layout:"admin",components:{PageHeader:h.a,Select:f.a,DateRange:y.a,Pagination:m.a},watchQuery:!0,asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var n,r,o,c,filter,l,d,j,f,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.query,r=e.store,o=e.$axios,c={fromDate:null,toDate:null,type:null,page:n.page||1,DistributorId:null,CityId:null},filter=k(k({},c),n),l=Object(object.a)(filter),t.next=6,r.dispatch("admin/common/searchCities");case 6:return t.next=8,r.dispatch("admin/common/searchDistributors",{query:n.DistributorId});case 8:return t.next=10,r.dispatch("admin/reportRevenue/fetch",l);case 10:return d="",t.next=13,o.get("/admin/city/".concat(n.CityId));case 13:if(j=t.sent,f=j.data.name,!n.DistributorId){t.next=20;break}return t.next=18,o.get("/admin/distributor/".concat(n.DistributorId));case 18:m=t.sent,d=m.data.name;case 20:return t.abrupt("return",{tableFilter:filter,cityIdLabel:f,DistributorLabel:d});case 21:case"end":return t.stop()}}),t)})))()},data:function(){return{loading:!1,optionType:[{slug:"day",label:"Theo ngày"},{slug:"week",label:"Theo tuần"},{slug:"month",label:"Theo tháng"}]}},computed:k(k(k({},Object(c.d)("admin/common",["optionCities","optionDistributors"])),Object(c.d)("admin/reportRevenue",["times","pagination"])),{},{userLoged:function(){return this.$store.state.auth.user}}),methods:{moment:j.a,fetchData:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var filter;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:filter=Object(object.a)(k(k(k({},t.$route.query),t.tableFilter),e)),t.$router.push({query:filter});case 2:case"end":return n.stop()}}),n)})))()},updatePage:function(e){this.fetchData({page:e})},updateSelect:function(e){this.fetchData({type:e,page:null})},updateDistributorId:function(e){this.DistributorId=e,this.fetchData({DistributorId:e,page:null})},updateCityId:function(e){this.CityId=e,this.fetchData({CityId:e,page:null})},updateDaterange:function(e){var t=null,n=null;null!==e&&(t=Object(l.a)(new Date(e[0]),"yyyy-MM-dd"),n=Object(l.a)(new Date(e[1]),"yyyy-MM-dd")),this.fetchData({fromDate:t,toDate:n,page:null})},remoteDistributor:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,n.next=3,t.$store.dispatch("admin/common/searchDistributors",{query:e});case 3:t.loading=!1;case 4:case"end":return n.stop()}}),n)})))()},downloadData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$axios.get("/admin/report/revenue",{params:k(k({},e.$route.query),{},{download:!0})}).then((function(e){var t=new Blob([e.data],{type:"application/csv"}),link=document.createElement("a");link.href=URL.createObjectURL(t),link.download="data.csv",link.click(),URL.revokeObjectURL(link.href)})).catch(console.error);case 3:e.loading=!1;case 4:case"end":return t.stop()}}),t)})))()}}},O=n(12),component=Object(O.a)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("PageHeader",{attrs:{title:"Báo cáo doanh thu"}}),e._v(" "),n("div",{staticClass:"w-full"},[n("div",{staticClass:"mt-5 flex flex-wrap md:flex-nowrap"},[n("Select",{staticClass:"mr-5 mb-2 md:w-40",attrs:{placeholder:"Chọn thời gian",options:e.optionType,selected:e.$route.query.type},on:{changeValue:e.updateSelect}}),e._v(" "),"admin"==e.userLoged.type?n("div",{staticClass:"mr-5 mb-2"},[n("el-select",{attrs:{value:e.DistributorLabel,placeholder:"Nhà phân phối",filterable:"",remote:"","remote-method":e.remoteDistributor,loading:e.loading,clearable:""},on:{change:e.updateDistributorId}},e._l(e.optionDistributors,(function(e){return n("el-option",{key:e.slug,attrs:{label:e.label,value:e.slug}})})),1)],1):e._e(),e._v(" "),n("div",{staticClass:"mr-5 mb-2"},[n("el-select",{attrs:{value:e.cityIdLabel,placeholder:"Thành phố",clearable:""},on:{change:e.updateCityId}},e._l(e.optionCities,(function(e){return n("el-option",{key:e.slug,attrs:{label:e.label,value:e.slug}})})),1)],1),e._v(" "),n("div",{staticClass:"flex"},[n("div",{staticClass:"mr-5"},[n("DateRange",{attrs:{"selected-range":[e.$route.query.fromDate,e.$route.query.toDate]},on:{changeDateRange:e.updateDaterange}})],1)]),e._v(" "),n("div",{staticClass:"mr-5 mb-2"},[n("el-button",{attrs:{type:"primary",disabled:0==e.times.length||e.loading,icon:"el-icon-download"},on:{click:e.downloadData}},[e._v("\n                    Tải xuống\n                ")])],1)],1)]),e._v(" "),n("div",[n("el-table",{staticClass:"w-full",attrs:{data:e.times,stripe:""}},[n("el-table-column",{attrs:{prop:"formatCreatedAt",label:"Thời gian"},scopedSlots:e._u([{key:"default",fn:function(t){return["day"===e.$route.query.type?n("span",[e._v("\n                        "+e._s(e.moment(t.row.formatCreatedAt,"YYYYMMDD").format("DD-MM-YYYY"))+"\n                    ")]):e._e(),e._v(" "),"week"===e.$route.query.type?n("span",[e._v("\n                        "+e._s(e.moment(t.row.formatCreatedAt,"YYYYww").format("ww-YYYY"))+"\n                    ")]):n("span",[e._v("\n                        "+e._s(e.moment(t.row.formatCreatedAt,"YYYYMM").format("MM-YYYY"))+"\n                    ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"total",label:"Doanh thu"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("formatNumber")(parseInt(t.row.total)||0)))])]}}])})],1)],1),e._v(" "),n("div",[n("Pagination",{attrs:{"page-size":e.pagination.pageSize,total:e.pagination.total,"current-page":e.pagination.page},on:{changePage:e.updatePage}})],1)],1)}),[],!1,null,null,null);t.default=component.exports},707:function(e,t,n){"use strict";var r={props:{title:{type:String,require:!0},activeName:{type:String,require:!0}},methods:{goBack:function(){this.$router.go(-1)}}},o=n(12),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-page-header",{staticClass:"mb-5",attrs:{content:e.title},on:{back:e.goBack}})}),[],!1,null,null,null);t.a=component.exports},709:function(e,t,n){var r=n(265),o=n(259),c=n(710),l=n(261),d=n(114),j=n(713),f=n(263),m=n(407),h=f((function(object,e){var t={};if(null==object)return t;var n=!1;e=r(e,(function(path){return path=l(path,object),n||(n=path.length>1),path})),d(object,m(object),t),n&&(t=o(t,7,j));for(var f=e.length;f--;)c(t,e[f]);return t}));e.exports=h},710:function(e,t,n){var r=n(261),o=n(711),c=n(712),l=n(94);e.exports=function(object,path){return path=r(path,object),null==(object=c(object,path))||delete object[l(o(path))]}},711:function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},712:function(e,t,n){var r=n(262),o=n(409);e.exports=function(object,path){return path.length<2?object:r(object,o(path,0,-1))}},713:function(e,t,n){var r=n(408);e.exports=function(e){return r(e)?void 0:e}},714:function(e,t,n){var r=n(264),o=n(114),c=n(715),l=n(260),d=n(172),j=n(95),f=Object.prototype.hasOwnProperty,m=c((function(object,source){if(d(source)||l(source))o(source,j(source),object);else for(var e in source)f.call(source,e)&&r(object,e,source[e])}));e.exports=m},715:function(e,t,n){var r=n(716),o=n(717);e.exports=function(e){return r((function(object,t){var n=-1,r=t.length,c=r>1?t[r-1]:void 0,l=r>2?t[2]:void 0;for(c=e.length>3&&"function"==typeof c?(r--,c):void 0,l&&o(t[0],t[1],l)&&(c=r<3?void 0:c,r=1),object=Object(object);++n<r;){var source=t[n];source&&e(object,source,n,c)}return object}))}},716:function(e,t,n){var r=n(170),o=n(406),c=n(266);e.exports=function(e,t){return c(o(e,t,r),e+"")}},717:function(e,t,n){var r=n(173),o=n(260),c=n(171),l=n(61);e.exports=function(e,t,object){if(!l(object))return!1;var n=typeof t;return!!("number"==n?o(object)&&c(t,object.length):"string"==n&&t in object)&&r(object[t],e)}},718:function(e,t,n){"use strict";var r=n(6),o=(n(404),n(709)),c=n.n(o),l=n(714),d=n.n(l),j={props:{pageSize:{type:Number,default:12},pagerCount:{type:Number,default:7},total:{type:Number,require:!0},currentPage:{type:Number,default:1},queryParam:{type:String,default:"page"}},methods:{go:function(e){this.$emit("changePage",e),this.$router.push(this.to(e))},to:function(e){var path=this.$route.path,t=c()(this.$route.query,[this.queryParam]);return{path:path,query:1!==e?d()({},t,Object(r.a)({},this.queryParam,e)):t}}}},f=n(12),component=Object(f.a)(j,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.total>1?n("el-pagination",{staticClass:"text-center mt-5",attrs:{"page-size":e.pageSize,"pager-count":e.pagerCount,total:e.total,"current-page":e.currentPage,background:"",layout:"prev, pager, next"},on:{"current-change":e.go}}):e._e()],1)}),[],!1,null,null,null);t.a=component.exports},726:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(6);n(15),n(17),n(13),n(19),n(14),n(20);function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var l=function(e){return Object.keys(e).filter((function(t){return null!=e[t]&&""!==e[t]})).reduce((function(a,t){return c(c({},a),{},Object(r.a)({},t,e[t]))}),{})}},727:function(e,t,n){"use strict";var r={props:{selectedRange:{type:Array,require:!1}},data:function(){return{pickerOptions:{shortcuts:[{text:"Tuần trước",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.$emit("pick",[n,t])}},{text:"Tháng trước",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.$emit("pick",[n,t])}},{text:"3 tháng",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.$emit("pick",[n,t])}}]},dateValue:this.selectedRange||[]}},methods:{updateDateRange:function(){this.$emit("changeDateRange",this.dateValue)}}},o=n(12),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"To","start-placeholder":"Ngày bắt đầu","end-placeholder":"Ngày kết thúc","picker-options":e.pickerOptions,format:"dd-MM-yyyy"},on:{change:e.updateDateRange},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})}),[],!1,null,null,null);t.a=component.exports},729:function(e,t,n){"use strict";var r={props:{options:{type:[Array,Object],require:!0},placeholder:{type:String,require:!1},selected:{type:String,require:!1},disabled:{type:Boolean,default:!1}},data:function(){return{value:this.selected||""}},methods:{updateValue:function(){this.$emit("changeValue",this.value)}}},o=n(12),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-select",{staticClass:"w-full",attrs:{clearable:"",placeholder:e.placeholder||"Lựa chọn",disabled:e.disabled},on:{change:e.updateValue},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return n("el-option",{key:e.slug,attrs:{label:e.label,value:e.slug}})})),1)}),[],!1,null,null,null);t.a=component.exports},896:function(e,t,n){var map={"./af":743,"./af.js":743,"./ar":744,"./ar-dz":745,"./ar-dz.js":745,"./ar-kw":746,"./ar-kw.js":746,"./ar-ly":747,"./ar-ly.js":747,"./ar-ma":748,"./ar-ma.js":748,"./ar-sa":749,"./ar-sa.js":749,"./ar-tn":750,"./ar-tn.js":750,"./ar.js":744,"./az":751,"./az.js":751,"./be":752,"./be.js":752,"./bg":753,"./bg.js":753,"./bm":754,"./bm.js":754,"./bn":755,"./bn-bd":756,"./bn-bd.js":756,"./bn.js":755,"./bo":757,"./bo.js":757,"./br":758,"./br.js":758,"./bs":759,"./bs.js":759,"./ca":760,"./ca.js":760,"./cs":761,"./cs.js":761,"./cv":762,"./cv.js":762,"./cy":763,"./cy.js":763,"./da":764,"./da.js":764,"./de":765,"./de-at":766,"./de-at.js":766,"./de-ch":767,"./de-ch.js":767,"./de.js":765,"./dv":768,"./dv.js":768,"./el":769,"./el.js":769,"./en-au":770,"./en-au.js":770,"./en-ca":771,"./en-ca.js":771,"./en-gb":772,"./en-gb.js":772,"./en-ie":773,"./en-ie.js":773,"./en-il":774,"./en-il.js":774,"./en-in":775,"./en-in.js":775,"./en-nz":776,"./en-nz.js":776,"./en-sg":777,"./en-sg.js":777,"./eo":778,"./eo.js":778,"./es":779,"./es-do":780,"./es-do.js":780,"./es-mx":781,"./es-mx.js":781,"./es-us":782,"./es-us.js":782,"./es.js":779,"./et":783,"./et.js":783,"./eu":784,"./eu.js":784,"./fa":785,"./fa.js":785,"./fi":786,"./fi.js":786,"./fil":787,"./fil.js":787,"./fo":788,"./fo.js":788,"./fr":789,"./fr-ca":790,"./fr-ca.js":790,"./fr-ch":791,"./fr-ch.js":791,"./fr.js":789,"./fy":792,"./fy.js":792,"./ga":793,"./ga.js":793,"./gd":794,"./gd.js":794,"./gl":795,"./gl.js":795,"./gom-deva":796,"./gom-deva.js":796,"./gom-latn":797,"./gom-latn.js":797,"./gu":798,"./gu.js":798,"./he":799,"./he.js":799,"./hi":800,"./hi.js":800,"./hr":801,"./hr.js":801,"./hu":802,"./hu.js":802,"./hy-am":803,"./hy-am.js":803,"./id":804,"./id.js":804,"./is":805,"./is.js":805,"./it":806,"./it-ch":807,"./it-ch.js":807,"./it.js":806,"./ja":808,"./ja.js":808,"./jv":809,"./jv.js":809,"./ka":810,"./ka.js":810,"./kk":811,"./kk.js":811,"./km":812,"./km.js":812,"./kn":813,"./kn.js":813,"./ko":814,"./ko.js":814,"./ku":815,"./ku.js":815,"./ky":816,"./ky.js":816,"./lb":817,"./lb.js":817,"./lo":818,"./lo.js":818,"./lt":819,"./lt.js":819,"./lv":820,"./lv.js":820,"./me":821,"./me.js":821,"./mi":822,"./mi.js":822,"./mk":823,"./mk.js":823,"./ml":824,"./ml.js":824,"./mn":825,"./mn.js":825,"./mr":826,"./mr.js":826,"./ms":827,"./ms-my":828,"./ms-my.js":828,"./ms.js":827,"./mt":829,"./mt.js":829,"./my":830,"./my.js":830,"./nb":831,"./nb.js":831,"./ne":832,"./ne.js":832,"./nl":833,"./nl-be":834,"./nl-be.js":834,"./nl.js":833,"./nn":835,"./nn.js":835,"./oc-lnc":836,"./oc-lnc.js":836,"./pa-in":837,"./pa-in.js":837,"./pl":838,"./pl.js":838,"./pt":839,"./pt-br":840,"./pt-br.js":840,"./pt.js":839,"./ro":841,"./ro.js":841,"./ru":842,"./ru.js":842,"./sd":843,"./sd.js":843,"./se":844,"./se.js":844,"./si":845,"./si.js":845,"./sk":846,"./sk.js":846,"./sl":847,"./sl.js":847,"./sq":848,"./sq.js":848,"./sr":849,"./sr-cyrl":850,"./sr-cyrl.js":850,"./sr.js":849,"./ss":851,"./ss.js":851,"./sv":852,"./sv.js":852,"./sw":853,"./sw.js":853,"./ta":854,"./ta.js":854,"./te":855,"./te.js":855,"./tet":856,"./tet.js":856,"./tg":857,"./tg.js":857,"./th":858,"./th.js":858,"./tk":859,"./tk.js":859,"./tl-ph":860,"./tl-ph.js":860,"./tlh":861,"./tlh.js":861,"./tr":862,"./tr.js":862,"./tzl":863,"./tzl.js":863,"./tzm":864,"./tzm-latn":865,"./tzm-latn.js":865,"./tzm.js":864,"./ug-cn":866,"./ug-cn.js":866,"./uk":867,"./uk.js":867,"./ur":868,"./ur.js":868,"./uz":869,"./uz-latn":870,"./uz-latn.js":870,"./uz.js":869,"./vi":871,"./vi.js":871,"./x-pseudo":872,"./x-pseudo.js":872,"./yo":873,"./yo.js":873,"./zh-cn":874,"./zh-cn.js":874,"./zh-hk":875,"./zh-hk.js":875,"./zh-mo":876,"./zh-mo.js":876,"./zh-tw":877,"./zh-tw.js":877};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(map,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return map[e]}r.keys=function(){return Object.keys(map)},r.resolve=o,e.exports=r,r.id=896}}]);